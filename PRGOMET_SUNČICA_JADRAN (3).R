load("C:/Users/1/Desktop/rudarenjeFiles/wind.RData")
load("C:/Users/1/Desktop/rudarenjeFiles/LonLat_sep.RData")

save(wind_data, lat, lon, file="jadran.Rda")
load("jadran.Rda")
#view(wind_data)

# provjeriti deimenzionalnost podataka
# razumijemo li strukturu?
dim(wind_data)
#[1]  2212 54056
str(wind_data)#ispisuje el matrice po stupcima redom
# num [1:2212, 1:54056] 0.697 1.174 0.949 0.725 0.712 ...
ncol(wind_data)
#[1] 54056
nrow(wind_data)
#[1] 2212

dim(lon)
#[1]    1 1106

str(lon)
# num [1, 1:1106] 13.1 12.9 13 13.1 13.2 ...
# - attr(*, "Csingle")= logi TRUE

dim(lat)
#[1]    1 1106
str(lat)
# num [1, 1:1106] 45.6 45.5 45.5 45.5 45.5 ...
# - attr(*, "Csingle")= logi TRUE

# odabiremo jedan dan (stupac u tablici, odabiremo sve retke za neki indeks)

br_uzoraka = 1
stupac <- sample(1:ncol(wind_data), br_uzoraka) #izaberi 1 uzorak od svih(ovde radimo sa stupcima)
stupac
#[1] 5670

scena <- wind_data[,stupac] #svi retci random odabranog stupca(tj taj stupac)

duljina <- length(scena)/2 # scena je sastavljena od u i v (jednako velike) komponente, trebamo ih razdvojiti
duljina
#[1] 1106
u <- scena[1:duljina]  #svi u-ovi iz odabranog stupca 
v <- scena[-(1:duljina)] #svi v-ovi iz odabranog stupca

# ovako to izgleda kao graf (tražimo li graf uopće?)
plot(u, v) #tockovno
plot(u, v, type="l") #linearno

# ne. nacrtajmo lokacije koje nas zanimaju (dane su lon i lat)
plot(lon, lat, col="red", xlab="lon", ylab="lat", main="Mjerne točke")


# nas zapravo zanima zanima vektorsko polje u tim točkama, vektorsko polje dano s (u,v) komponentama...
#install.packages("pracma")
##?quiver

library(pracma)
quiver(lon, lat, u, v, scale=0.1) #prikazuje vektore brzine kao strelice s komponentama 
#(u,v) u točkama (x,y)
#scale=adjusts the length of arrows




# alternativa
#install.packages("fields")
library(fields)
#?arrow.plot
lon2 = as.vector(lon)
lat2 = as.vector(lat)
plot(lon2, lat2, col="red", xlab="lon", ylab="lat", main="Mjerne točke")
arrow.plot(lon2, lat2, u, v, length = 0.05, arrow.ex=0.1, true.angle=T)


# nacrtajte
# - manji broj točaka (primjerice svako drugu), da se bolje vide vektori
#a[seq(1, length(a), 2)] #uzet 1.,3.,... el niza a
quiver(lon[seq(1, length(lon), 2)], lat[seq(1, length(lat), 2)], u[seq(1, length(u), 2)], v[seq(1, length(v), 2)], scale=0.1)
# uzmite dvije točke i izračunajte korelaciju među njima
a <- sample(length(lat), 1)
a
#[1] 42
b <- sample(length(lat), 1)
b
#[1] 650
cor(c(lon[a],lat[a]),c(lon[b],lat[b]))
#[1] 1

# kako se korelacija ponaša kao funkcija udaljenosti između dvije točke
#kao konstantna funkcija sa vrijednosti 1

# gore smo promatrali jednu scenu u vremenu
# odaberite neku točku u prostoru i izračunajte apsolutnu vrijednost vjetra u toj točci
br<- sample(1:(nrow(wind_data))/2, 1)#stavimo raspon sa od:do(ili bez od pa se podrazumijeva 1),br uzoraka
br
#[1] 791
xkoord<-wind_data[br,]
xkoord
length(xkoord)
#[1] 54056

ykoord<-wind_data[br+((nrow(wind_data))/2),]
ykoord
length(ykoord)
#[1] 54056

aps<-sqrt(xkoord^2+ykoord^2)
aps
# [1]  1.39792860  0.56860240  1.90135596  3.30477480  2.05116941  6.91633008  7.05177306  6.64272144
# [9]  4.57486098  1.76298913  3.66281597  2.95252699  4.73745044  4.66962768  5.98952479  8.43280290
# [17] 10.04296881  8.09390992  6.66950655  8.85172500  8.98802030  7.58449357  5.74259604  0.66986473
# [25]  5.37402153  7.04425092  7.82367830  8.16260878 10.09092437 10.63183756 10.77120861 12.30803569
# [33] 11.74823803 11.65515565 11.27549765  9.92764193  7.34705647  5.88070397  3.34289665  3.07484188
# [41]  1.51860778  2.44487964  0.46567324  1.91732971  1.38305950  3.08272798  2.81504484  5.03006527
# [49]  5.54628037  8.34343728  9.97757113 12.01307669 14.06035612  7.41779739  5.63492818  1.28434828
# [57]  3.17532653  2.88070416  6.06624256  7.36506248  9.96720053  3.12498237 10.38555222 10.87402802
# [65]  9.46512259  6.93585797  3.90330842  2.15509333  3.22018269  5.13839398  5.60558784  5.78473070
# [73]  6.10540763  6.82307483  5.00930109  4.37182820  2.44702631  2.61842064  2.92577436  5.27675557
# [81]  7.86977094 11.40116532 10.94707779 11.04201758 11.13438826 10.79635613 11.15727749 11.24288399
# [89] 10.75421959 10.05277439  9.23596002  8.98506762  8.57715111  7.39118163  5.45085679  3.86181935
# [97]  4.85420354  4.97264399  5.22783843  5.56167930  4.59016030  3.01053144  2.77779553  4.29765084
# [105]  7.27409808  9.24540041 10.20681667  9.75693519  8.45805555  7.97074562  8.97073375  9.61067316
# [113]  8.57210130  7.70025333  7.45170525  7.02753647  7.69426714  7.49699957  6.50286677  6.37010253
# [121]  6.96190248  6.62783629  4.58328900  3.75743192  4.24287973  4.24515448  2.04539143  3.09487135
# [129]  2.72876089  3.07879440  1.17253717  1.55808785  2.22189519  2.21238180  2.64286420  3.05729501
# [137]  4.51525494  4.51216760  6.92865416  6.66411362  9.52862496 11.49493232  9.31082652  3.05092883
# [145]  4.61420050  8.72260706  9.37775197 10.14113516 10.04948373  7.90814597  5.35409095  5.35043533
# [153]  5.08652219  4.23024397  1.56944619  1.11739640  0.82196032  1.76447608  0.64971996  1.31475284
# [161]  3.21560854  4.52680632  5.94283139  5.06537869  5.93668542  5.46996185  6.21524025  7.19938084
# [169]  7.26294257  4.95781031  5.05312079  3.11124149  5.07149719  2.80612287  1.30779798  3.85366981
# [177]  4.12771367  5.89512418  5.72692087  5.86846476  8.07921547  6.56749142  3.79866932  3.64067920
# [185]  3.35969721  3.48744058  4.01984363  4.80282995  5.74493385  6.41140758  4.94624954  4.57307536
# [193]  5.83180053  5.06926722  2.94119703  3.19365774  2.76935978  3.55687117  2.37611265  4.10938848
# [201]  3.98749279  2.74316613  3.59486343  3.71525622  5.83560743  7.31856824  8.35382308  8.65322112
# [209]  8.37821176  6.76445093  4.20694946  2.99507027  4.86357829  5.55549086  3.26080004  1.16014095
# [217]  0.09868828  1.23597329  0.69205917  1.31893338  0.34519274  1.25927638  1.14037136  2.87591752
# [225]  5.25877767  6.96816515  7.53498978  6.29338933  6.09618325  4.76639279  2.39178095  1.60078098
# [233]  2.07300890  2.53505667  0.92807908  1.75277871  2.30328805  2.70005825  2.89889912  2.66970454
# [241]  4.42645493  6.42929920  9.09889763  9.55854447 10.91895389 10.16762961 10.38840530  9.71873947
# [249]  9.58692068  9.86030708  8.63308724  3.88750290  2.67611734  0.85822013  2.40068634  1.98855046
# [257]  1.13580749  1.98218212  0.92689424  0.07599763  2.35910479  2.68265520  0.26889826  2.72799344
# [265]  2.40335432  3.25732081  1.78089050  2.31889188  0.40037409  1.85058884  3.44289850  3.75914805
# [273]  2.47423492  1.88242464  4.08010811  3.96278572  1.60292864  1.83580948  3.26262778  2.06839157
# [281]  1.70731539  2.73575197  3.29944281  1.89733008  5.14942561  6.66196905  4.34805210  3.24352791
# [289]  4.07702267  3.75566961  3.62555148  1.86506707  3.52981131  5.09456830  6.63397115  6.06715986
# [297]  6.28112749  6.86495147  6.60758768  4.13382987  2.63860431  2.77341270  2.31960038  3.69660303
# [305]  3.89441714  2.38767108  2.15192881  3.49830054  6.72374435  6.94027879  6.36553304  7.18375879
# [313]  5.11740642  3.01274978  2.70066415  2.88776708  1.57001424  2.27303915  1.57589489  1.11998357
# [321]  1.69936145  1.61239366  2.06951783  1.60879029  0.97355119  1.62037188  3.70706353  3.70241584
# [329]  2.33500327  0.29429872  2.84567200  0.35406928  1.87811694  1.97295959  2.81466300  2.82021467
# [337]  1.06245110  0.89505574  2.13534037  1.72409950  2.43890907  2.30650508  1.19620452  2.12740796
# [345]  1.09108442  1.82001199  1.09814862  1.14149360  2.28572323  3.58796219  4.29952744  3.51005500
# [353]  4.51143857  5.76150916  6.02874256  4.48047994  5.45333244  5.52279283  4.67984006  4.03476016
# [361]  4.19797771  4.71706417  3.92448801  3.79872740  3.59659232  2.50734478  2.70677436  1.05343983
# [369]  2.43964345  0.59093296  2.73695645  0.60728188  4.86236021  5.52528607  0.70006192  1.49751190
# [377]  2.36047074  3.04932037  2.84220433  1.68241673  1.02932015  2.87836931  3.55889737  4.04147698
# [385]  1.72289279  0.94722014  4.10815728  3.66559502  1.86440137  2.19503796  3.34285326  2.62710865
# [393]  1.36293117  2.18159576  2.98978932  1.01834629  1.21986399  2.10318962  2.49469118  2.49171618
# [401]  2.25553586  2.46588938  3.12393545  3.84100152  3.73584653  3.74588671  2.60241272  2.53407322
# [409]  3.64300967  4.67470110  1.82560347  3.91325179  1.76293777  2.28653889  4.53805033  4.32371404
# [417]  1.79982492  2.93612407  2.98568459  3.62736108  2.14680401  0.96835108  3.02398946  3.44003139
# [425]  5.00498598  6.23214703  6.83306204  6.57962689  6.28606693  6.42798299  4.48141818  0.62495206
# [433]  4.73617269  3.60644565  6.29464678  3.20596478  1.46246581  2.90882639  0.34666688  0.41281245
# [441]  2.45615532  2.95115045  1.82345075  3.06731780  2.02827271  2.31956564  3.26058853  2.87658504
# [449]  2.07694217  2.47495389  2.08937746  0.98726237  3.68119251  5.39875533  8.20022026  5.33771204
# [457]  4.63911210  5.20242015  3.66133278  3.37425714  4.80699441  5.51762922  6.32772171  8.06151379
# [465]  9.51899196  6.15922059  2.88030126  0.77668365  2.35320426  2.07775236  3.18518875  1.55783829
# [473]  1.67092895  1.12713680  2.57941753  1.91068525  1.09885559  1.35358223  3.28180557  1.80811263
# [481]  1.20071408  3.02432287  3.90953127  4.22300120  4.13228999  3.87924941  0.63298497  2.00001505
# [489]  2.10558979  4.14674789  5.32831991  4.12431820  4.48645308  6.32535548  6.82981325  7.25740572
# [497]  8.35383575  6.26746817  5.25965574  4.52158822  4.91558101  5.02680656  8.54522407  7.72239523
# [505]  6.79807328  6.51475297  7.21323319  5.31164739  2.81391026  1.29687569  4.32208296  3.05555667
# [513]  0.37222523  0.42404114  2.42597036  1.23155586  1.90355324  2.89413478  3.17216552  1.76367914
# [521]  3.62600723  4.86105122  5.38804641  3.20296293  4.76280918  2.47430349  3.72568815  2.45773159
# [529]  3.92203306  4.15147207  2.35960048  2.66743269  1.34752452  2.85378720  3.09397953  1.27039459
# [537]  0.07275045  2.17849627  1.52588824  0.72918528  1.22651974  1.82128445  1.89966905  0.17418706
# [545]  1.89084167  1.23114258  3.26517140  1.95571686  0.30563457  1.33358637  3.58291172  2.88788130
# [553]  1.84762176  2.60357762  3.73888190  4.06942640  1.88939342  1.29104270  3.74228455  2.09450648
# [561]  1.30196037  2.33888483  3.34900606  3.11053805  1.13805951  2.54404019  1.43377631  1.36532853
# [569]  5.10801456  5.51183655  5.69616160  4.07455399  4.07433833  2.75510074  1.46617090  1.16873752
# [577]  2.43111559  2.98829920  3.73279329  3.67806828  4.85580267  5.57814492  5.98172463  5.13147548
# [585]  6.06817813  6.72486753  5.91844406  4.05203665  4.70688343  5.21611655  3.94759876  3.65588232
# [593]  3.72525012  3.69266895  5.01635956  4.70671290  3.40299328  2.31485256  4.33593085  3.67814669
# [601]  1.24356961  1.38627898  3.80526499  2.15934203  1.41374545  2.72999131  2.68773358  3.04598181
# [609]  1.86332074  1.96706687  1.99099303  1.90375597  0.75841290  1.05707354  3.46443981  1.63279414
# [617]  3.23221700  4.09596922  3.60659962  3.15258592  3.59949473  2.99540424  4.56625419  1.25898884
# [625]  1.50277601  1.95263590  3.55047644  2.43582271  2.01348097  2.02026156  4.23101637  3.79414485
# [633]  3.91900851  3.11100696  5.38367760  5.00561625  2.85908681  2.56825518  4.44099832  3.38862777
# [641]  1.68881973  0.89126601  4.00993795  1.94257876  0.40985982  1.83007563  3.17683149  4.28015245
# [649]  3.58027583  4.62296219  3.23297594  4.67492897  2.87454952  3.45453222  4.03705980  5.19337232
# [657]  7.07373512  7.57760684  5.21043670  4.76238141  4.46712223  3.77770587  5.10158472  4.73759720
# [665]  2.23327533  1.70794896  2.95453717  2.64172560  4.96011520  5.93030896  5.63787399  4.76051896
# [673]  7.80144637  8.93402526 11.14171614  8.77660665  4.58322729  5.23198483  4.36759355  3.50513441
# [681]  2.95866999  3.51221328  2.71590613  4.89626245  3.55002085  2.91751313  4.40082304  3.64088427
# [689]  1.45849328  1.55991600  3.10006235  0.78204465  3.60813072  5.21715161  7.35744006  4.83003825
# [697]  5.00750497  4.85055735  4.43673706  2.57134988  2.02565594  3.08863585  2.37772976  2.10141234
# [705]  2.46050146  3.37136865  5.64084215  3.85174203  2.77101927  1.81225083  5.09361197  4.45320988
# [713]  3.31879718  2.38974668  4.92535484  3.08760789  1.86397584  1.45260856  3.08384699  0.95043394
# [721]  1.43109968  2.51688097  5.94020048  3.52987177  1.94092104  1.68787866  5.70967785  4.90039629
# [729]  2.89220359  3.86836484  3.19755866  4.00862566  1.87614811  1.73582807  3.89705678  4.56017058
# [737]  6.92799582  5.50310177  3.99289573  4.96392419  4.21141710  6.18818287  4.44371211  5.62083440
# [745]  5.56850385  5.15859621  4.19136699  5.53450556  6.07081097  6.35922705  5.12954467  5.87237906
# [753]  5.22018685  5.05114064  4.08544238  4.88103768  3.01284850  1.81583054  4.17237251  3.80504588
# [761]  1.16669341  1.39662669  3.91512624  2.57737317  1.93796659  0.86310994  3.08854518  1.90987474
# [769]  1.42496286  1.95950812  2.97815757  0.42510363  0.61961290  1.59348174  1.16405980  0.38469332
# [777]  1.52213187  2.91853862  0.87958644  1.54198163  1.30526378  2.13102785  2.83593097  2.98112938
# [785]  2.35098773  3.21940937  3.00004002  4.42118642  3.67489174  3.66633455  1.92419364  2.36519454
# [793]  1.67006539  3.41089708  4.34575948  4.56005628  6.82895765  8.07507786  7.27118576  4.84222171
# [801]  5.55861908  3.46310038  4.61720124  5.00231784  5.78956545  5.36643844  6.20142895  4.23853831
# [809]  2.48993288  2.90187037  2.23984995  2.66486687  1.64571584  2.15198041  2.70502090  0.77892918
# [817]  1.47737493  2.82466087  2.41293270  2.21132238  3.87121254  5.08767030  4.91269064  1.51232253
# [825]  1.88197863  2.60388149  5.60722355  5.12470131  4.03826918  4.66575527  4.48776933  4.44109207
# [833]  4.59035357  4.71618352  6.08235662  6.62654495  4.34441169  3.62900051  4.60154683  4.26192015
# [841]  3.26500497  2.97316652  5.07375805  5.09969131  3.05419263  1.93287263  4.34390156  4.20754432
# [849]  1.77085153  2.21576004  3.45347842  3.22289870  2.71423995  3.46147921  2.44108075  4.46868851
# [857]  3.09865742  3.74656319  4.24606887  5.64725042  3.10238468  3.77498917  2.95555812  5.07739778
# [865]  5.49280029  5.49697739  3.16988129  4.69867197  2.75625879  2.62830949  1.73064658  2.28249829
# [873]  1.78513992  1.56788429  1.95622059  2.10601400  1.87677780  1.47117414  3.00470063  2.34780399
# [881]  1.54949827  1.93024568  1.61496925  1.92038228  3.43872499  3.39504073  3.12677723  1.01264576
# [889]  0.99811933  0.95894143  3.84025419  1.50256352  1.02809752  0.70546136  3.32064762  2.26830987
# [897]  0.44869057  1.76847639  3.47873777  3.38162810  2.08415821  2.08813279  1.84655973  2.70586247
# [905]  2.73905977  4.39890731  3.41617279  1.87649233  3.72027654  3.88716958  1.22050171  2.89928970
# [913]  0.63096776  0.28470069  2.20648136  1.61986743  0.77520754  4.16523789  2.45884150  3.01001853
# [921]  4.12568931  4.27753626  3.16233888  3.20707786  1.33679764  1.59708614  2.93201509  1.60185679
# [929]  3.31522286  4.42398287  6.44793307  5.36296794  6.11273523  4.62321305  3.59539977  1.02228548
# [937]  2.05248263  2.03187913  2.47007950  0.31832702  1.60806769  2.87974954  3.37448454  4.87707074
# [945]  4.99094944  5.52823221  4.75294490  4.30865422  6.63239182  5.40952624  2.79015633  5.07750006
# [953]  4.23573245  4.12391498  3.79320315  5.32671442  4.02719964  1.48977576  4.80693939  0.39002899
# [961]  3.31604094  5.06403423  0.32179259  0.92778744  2.17315019  3.43844063  4.01903928  2.91646855
# [969]  2.76089718  3.31883897  2.98398833  1.34820016  2.30105437  3.31449910  4.05498887  2.25018116
# [977]  2.33094043  2.18495883  2.95826354  1.69846115  1.22749782  1.76684327  1.56092627  1.05410160
# [985]  2.47751007  4.65616097  6.72639477  4.15718713  2.74658712  3.25127967  1.65179369  1.28577152
# [993]  2.67254840  3.30911217  3.21787396  3.54048769  5.08901443  5.61388456  3.23586074  2.44858703
# [ reached getOption("max.print") -- omitted 53056 entries ]



# nacrtajte graf koji pokazuje kako se apsolutna vrijednost mijenja kroz vrijeme
plot(1:ncol(wind_data),aps,xlab="dani",ylab="aps vr")

# nacrtajte histogram koji pokazuje distribuciju apsolutnih vrijednosti u toj točci
hist(aps)

# postavite hipotezu i provjerite ju:
# - primjerice ako su apsolutne vrijednosti koreliranje, bit će korelirane u i v komponente
# - ili - imati će sličnu distribuciju (ili - ako imaju sličnu distribuciju imati će sličnu korelaciju 
#- morate imati mjeru sličnosti distribucije, pogledati entropijske mjere sličnost, tj. KLD)



# prikažite standardnu devijaciju za pojedinu točku - i kodirajte ju bojom
nizstdev=c()
for(i in 1:(nrow(wind_data))/2)
{
  xkoord<-wind_data[i,]
  
  ykoord<-wind_data[i+(nrow(wind_data)/2),]
  
  nizstdev=append(nizstdev,sd(sqrt(xkoord^2+ykoord^2)))
}

length(nizstdev)
#[1] 2212

library(lattice)
levelplot(sd~lon*lat,col.regions = rainbow)

# ili druge biblioteke za crtanje (po želji - na ovome se može izgubiti mnogo vremena, a da se malo doprinese analizi)
# leaflet, ggplot (ggmap)... usp. "Geocomputation with R", https://geocompr.robinlovelace.net/adv-map.html

#1. Jedna točka je izdvojenica (izdvojena je u geografskom prostoru) - uklonite ju
#provjera da je samo 1 izdvojenica
for(i in 1:length(lon)){
  if(lon[i]<14 & lat[i]==42){
    print(i)
  }
}
#[1] 633

lon_novi<-lon[-633]
lat_novi<-lat[-633]
plot(lon_novi,lat_novi)

#2. Pohranite matricu u nekom ljudima čitljivom formatu (primjerice, .csv) 
#- demonstirano je u popratnoj R datotci.
write.csv("jadran.Rda", "jadran.csv", row.names=F)